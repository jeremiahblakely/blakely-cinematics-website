<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reply Box Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-buttons { margin: 20px 0; }
        .test-buttons button { margin-right: 10px; padding: 10px; }
        #status { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Reply Box Toolbar Test</h1>
    
    <div class="test-buttons">
        <button onclick="testExpandClass()">Add 'expanded' Class</button>
        <button onclick="testRemoveClass()">Remove 'expanded' Class</button>
        <button onclick="checkToolbarVisibility()">Check Toolbar Visibility</button>
    </div>
    
    <div id="status">Status: Ready to test</div>
    
    <iframe src="admin/admin-mail.html" width="100%" height="600" style="border: 1px solid #ccc;"></iframe>
    
    <script>
        function testExpandClass() {
            const iframe = document.querySelector('iframe');
            const replyBox = iframe.contentDocument.getElementById('replyBox');
            if (replyBox) {
                replyBox.classList.add('expanded');
                document.getElementById('status').textContent = 'Added "expanded" class to reply box';
            } else {
                document.getElementById('status').textContent = 'Reply box not found';
            }
        }
        
        function testRemoveClass() {
            const iframe = document.querySelector('iframe');
            const replyBox = iframe.contentDocument.getElementById('replyBox');
            if (replyBox) {
                replyBox.classList.remove('expanded');
                document.getElementById('status').textContent = 'Removed "expanded" class from reply box';
            } else {
                document.getElementById('status').textContent = 'Reply box not found';
            }
        }
        
        function checkToolbarVisibility() {
            const iframe = document.querySelector('iframe');
            const replyBox = iframe.contentDocument.getElementById('replyBox');
            const writingTools = iframe.contentDocument.querySelector('.writing-tools');
            const replyActions = iframe.contentDocument.querySelector('.reply-actions');
            
            if (!replyBox) {
                document.getElementById('status').textContent = 'Reply box not found';
                return;
            }
            
            const hasExpanded = replyBox.classList.contains('expanded');
            const writingToolsDisplay = writingTools ? iframe.contentWindow.getComputedStyle(writingTools).display : 'not found';
            const buttonsVisible = replyActions ? iframe.contentWindow.getComputedStyle(replyActions).display : 'not found';
            
            document.getElementById('status').innerHTML = `
                Reply box has "expanded" class: ${hasExpanded}<br>
                Writing tools display: ${writingToolsDisplay}<br>
                Reply actions display: ${buttonsVisible}<br>
                Writing tools should be: ${hasExpanded ? 'visible (flex)' : 'hidden (none)'}<br>
                Buttons should always be visible
            `;
        }
    </script>
</body>
</html>